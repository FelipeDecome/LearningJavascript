{"version":3,"sources":["../../app-es6/services/NegociacoesService.js"],"names":["HttpService","ConnectionFactory","NegociacaoDao","Negociacao","NegociacoesService","_http","Promise","all","obterNegociacoesSemana","obterNegociacoesSemanaAnterior","obterNegociacoesSemanaRetrasada","then","periodos","reduce","dados","periodo","concat","catch","e","console","log","Error","get","negociacoes","map","obj","Date","data","quantidade","valor","erro","negociacao","getConnection","connection","dao","adiciona","index","apagaTodos","listaAtual","obterNegociacoes","filter","some","negociacaoExistente","isEquals"],"mappings":"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","file":"NegociacoesService.js","sourcesContent":["import HttpService from \"./HttpService.js\";\nimport ConnectionFactory from \"./ConnectionFactory.js\";\nimport NegociacaoDao from \"./../dao/NegociacaoDao.js\";\nimport Negociacao from \"./../models/Negociacao.js\";\n\nexport default class NegociacoesService {\n  constructor() {\n    this._http = new HttpService();\n  }\n\n  obterNegociacoes() {\n    return Promise.all([\n      this.obterNegociacoesSemana(),\n      this.obterNegociacoesSemanaAnterior(),\n      this.obterNegociacoesSemanaRetrasada(),\n    ])\n      .then((periodos) =>\n        periodos.reduce((dados, periodo) => dados.concat(periodo), [])\n      )\n      .catch((e) => {\n        console.log(e);\n        throw new Error(\"Não foi possível importar as negociações\");\n      });\n  }\n\n  obterNegociacoesSemana() {\n    return this._http\n      .get(\"negociacoes/semana\")\n      .then((negociacoes) => {\n        console.log(negociacoes);\n        return negociacoes.map(\n          (obj) => new Negociacao(new Date(obj.data), obj.quantidade, obj.valor)\n        );\n      })\n      .catch((erro) => {\n        console.log(erro);\n        throw new Error(\"Não foi possível importar as negociações da semana.\");\n      });\n  }\n\n  obterNegociacoesSemanaAnterior() {\n    return this._http\n      .get(\"negociacoes/anterior\")\n      .then((negociacoes) => {\n        console.log(negociacoes);\n        return negociacoes.map(\n          (obj) => new Negociacao(new Date(obj.data), obj.quantidade, obj.valor)\n        );\n      })\n      .catch((erro) => {\n        console.log(erro);\n        throw new Error(\n          \"Não foi possível importar as negociações da semana anterior.\"\n        );\n      });\n  }\n\n  obterNegociacoesSemanaRetrasada() {\n    return this._http\n      .get(\"negociacoes/retrasada\")\n      .then((negociacoes) => {\n        console.log(negociacoes);\n        return negociacoes.map(\n          (obj) => new Negociacao(new Date(obj.data), obj.quantidade, obj.valor)\n        );\n      })\n      .catch((erro) => {\n        console.log(erro);\n        throw new Error(\n          \"Não foi possível importar as negociações da semana retrasada.\"\n        );\n      });\n  }\n\n  cadastrar(negociacao) {\n    return ConnectionFactory.getConnection()\n      .then((connection) => new NegociacaoDao(connection))\n      .then((dao) => dao.adiciona(negociacao))\n      .then(() => \"Negociação adicionada com sucesso.\")\n      .catch((e) => {\n        throw new Error(\"Não foi possível adicionar a negociação\");\n      });\n  }\n\n  lista() {\n    return ConnectionFactory.getConnection()\n      .then((connection) => new NegociacaoDao(connection))\n      .then((dao) => dao.index())\n      .catch((e) => {\n        console.log(e);\n        throw new Error(\"Não foi possível listar as negociações\");\n      });\n  }\n\n  apaga() {\n    return ConnectionFactory.getConnection()\n      .then((connection) => new NegociacaoDao(connection))\n      .then((dao) => dao.apagaTodos())\n      .catch((e) => {\n        throw new Error(e);\n      });\n  }\n\n  importa(listaAtual) {\n    return this.obterNegociacoes().then((negociacoes) =>\n      negociacoes.filter(\n        (negociacao) =>\n          !listaAtual.negociacoes.some((negociacaoExistente) =>\n            negociacao.isEquals(negociacaoExistente)\n          )\n      )\n    );\n  }\n}\n"]}