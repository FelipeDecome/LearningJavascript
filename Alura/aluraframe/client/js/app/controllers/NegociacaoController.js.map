{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["currentInstance","negociacaoController","ListaNegociacoes","NegociacoesView","Negociacao","Mensagem","MensagemView","Bind","DateHelper","NegociacoesService","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_ordenacao","_listaNegociacoes","_mensagem","_service","_init","lista","then","negociacoes","forEach","negociacao","adiciona","catch","e","console","log","texto","setInterval","importarNegociacoes","event","preventDefault","_criaNegociacao","cadastrar","message","_limpaForm","importa","prop","sortInverse","sort","apaga","esvazia","toDate","value","parseInt","parseFloat","focus"],"mappings":";;;;;;;;;;;;;AA4He,WAASA,eAAT,GAA2B;AACxC,WAAOC,oBAAP;AACD;;qBAFuBD,e;;;;AA5HjBE,sB;;AACAC,qB;;AACAC,gB;;AAEAC,c;;AACAC,kB;;AAEAC,U;;AACAC,gB;;AAEAC,wB;;;;;;;;;;;;;;;;;;;;;AAEDC,0B;AACJ,wCAAc;AAAA;;AACZ,cAAIC,IAAIC,SAASC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAR;AACA,eAAKG,UAAL,GAAkBJ,EAAE,OAAF,CAAlB;AACA,eAAKK,gBAAL,GAAwBL,EAAE,aAAF,CAAxB;AACA,eAAKM,WAAL,GAAmBN,EAAE,QAAF,CAAnB;;AAEA,eAAKO,UAAL,GAAkB,EAAlB;;AAEA,eAAKC,iBAAL,GAAyB,IAAIZ,IAAJ,CACvB,IAAIL,gBAAJ,EADuB,EAEvB,IAAIC,eAAJ,CAAoBQ,EAAE,kBAAF,CAApB,CAFuB,EAGvB,UAHuB,EAIvB,SAJuB,EAKvB,MALuB,EAMvB,aANuB,CAAzB;;AASA,eAAKS,SAAL,GAAiB,IAAIb,IAAJ,CACf,IAAIF,QAAJ,EADe,EAEf,IAAIC,YAAJ,CAAiBK,EAAE,eAAF,CAAjB,CAFe,EAGf,OAHe,CAAjB;;AAMA,eAAKU,QAAL,GAAgB,IAAIZ,kBAAJ,EAAhB;;AAEA,eAAKa,KAAL;AACD;;;;kCAEO;AAAA;;AACN,iBAAKD,QAAL,CACGE,KADH,GAEGC,IAFH,CAEQ,UAACC,WAAD;AAAA,qBACJA,YAAYC,OAAZ,CAAoB,UAACC,UAAD,EAAgB;AAClC,sBAAKR,iBAAL,CAAuBS,QAAvB,CAAgCD,UAAhC;AACD,eAFD,CADI;AAAA,aAFR,EAOGE,KAPH,CAOS,UAACC,CAAD,EAAO;AACZC,sBAAQC,GAAR,CAAYF,CAAZ;AACA,oBAAKV,SAAL,CAAea,KAAf,GAAuBH,CAAvB;AACD,aAVH;;AAYAI,wBAAY,YAAM;AAChB,oBAAKC,mBAAL;AACD,aAFD,EAEG,IAFH;AAGD;;;mCAEQC,K,EAAO;AAAA;;AACdA,kBAAMC,cAAN;;AAEA,gBAAIV,aAAa,KAAKW,eAAL,EAAjB;AACA,iBAAKjB,QAAL,CACGkB,SADH,CACaZ,UADb,EAEGH,IAFH,CAEQ,UAACgB,OAAD,EAAa;AACjB,qBAAKrB,iBAAL,CAAuBS,QAAvB,CAAgCD,UAAhC;AACA,qBAAKP,SAAL,CAAea,KAAf,GAAuBO,OAAvB;;AAEA,qBAAKC,UAAL;AACD,aAPH,EAQGZ,KARH,CAQS,UAACC,CAAD;AAAA,qBAAQ,OAAKV,SAAL,CAAea,KAAf,GAAuBH,CAA/B;AAAA,aART;AASD;;;gDAEqB;AAAA;;AACpB,iBAAKT,QAAL,CACGqB,OADH,CACW,KAAKvB,iBADhB,EAEGK,IAFH,CAEQ,UAACC,WAAD,EAAiB;AACrB,qBAAKL,SAAL,CAAea,KAAf,GAAuB,oCAAvB;AACAR,0BAAYC,OAAZ,CAAoB,UAACC,UAAD;AAAA,uBAClB,OAAKR,iBAAL,CAAuBS,QAAvB,CAAgCD,UAAhC,CADkB;AAAA,eAApB;AAGD,aAPH,EAQGE,KARH,CAQS,UAACC,CAAD;AAAA,qBAAQ,OAAKV,SAAL,CAAea,KAAf,GAAuBH,CAA/B;AAAA,aART;AASD;;;+BAEIa,I,EAAM;AACT,gBAAI,KAAKzB,UAAL,IAAmByB,IAAvB,EAA6B;AAC3B,mBAAKxB,iBAAL,CAAuByB,WAAvB;AACD,aAFD,MAEO;AACL,mBAAKzB,iBAAL,CAAuB0B,IAAvB,CAA4BF,IAA5B;AACD;;AAED,iBAAKzB,UAAL,GAAkByB,IAAlB;AACD;;;oCAES;AAAA;;AACR,iBAAKtB,QAAL,CACGyB,KADH,GAEGtB,IAFH,CAEQ,UAACgB,OAAD,EAAa;AACjB,qBAAKpB,SAAL,CAAea,KAAf,GAAuBO,OAAvB;AACA,qBAAKrB,iBAAL,CAAuB4B,OAAvB;AACD,aALH,EAMGlB,KANH,CAMS,UAACC,CAAD;AAAA,qBAAQ,OAAKV,SAAL,CAAea,KAAf,GAAuBH,CAA/B;AAAA,aANT;AAOD;;;4CAEiB;AAChB,mBAAO,IAAI1B,UAAJ,CACLI,WAAWwC,MAAX,CAAkB,KAAKjC,UAAL,CAAgBkC,KAAlC,CADK,EAELC,SAAS,KAAKlC,gBAAL,CAAsBiC,KAA/B,CAFK,EAGLE,WAAW,KAAKlC,WAAL,CAAiBgC,KAA5B,CAHK,CAAP;AAKD;;;uCAEY;AACX,iBAAKlC,UAAL,CAAgBkC,KAAhB,GAAwB,EAAxB;AACA,iBAAKjC,gBAAL,CAAsBiC,KAAtB,GAA8B,CAA9B;AACA,iBAAKhC,WAAL,CAAiBgC,KAAjB,GAAyB,GAAzB;;AAEA,iBAAKlC,UAAL,CAAgBqC,KAAhB;AACD;;;;;;AAGGnD,0B,GAAuB,IAAIS,oBAAJ,E","file":"NegociacaoController.js","sourcesContent":["import ListaNegociacoes from \"./../models/ListaNegociacoes.js\";\nimport NegociacoesView from \"./../views/NegociacoesView.js\";\nimport Negociacao from \"./../models/Negociacao.js\";\n\nimport Mensagem from \"./../models/Mensagem.js\";\nimport MensagemView from \"./../Views/MensagemView.js\";\n\nimport Bind from \"./../helpers/Bind.js\";\nimport DateHelper from \"./../helpers/DateHelper.js\";\n\nimport NegociacoesService from \"./../services/NegociacoesService.js\";\n\nclass NegociacaoController {\n  constructor() {\n    let $ = document.querySelector.bind(document);\n    this._inputData = $(\"#data\");\n    this._inputQuantidade = $(\"#quantidade\");\n    this._inputValor = $(\"#valor\");\n\n    this._ordenacao = \"\";\n\n    this._listaNegociacoes = new Bind(\n      new ListaNegociacoes(),\n      new NegociacoesView($(\"#negociacoesView\")),\n      \"adiciona\",\n      \"esvazia\",\n      \"sort\",\n      \"sortInverse\"\n    );\n\n    this._mensagem = new Bind(\n      new Mensagem(),\n      new MensagemView($(\"#mensagemView\")),\n      \"texto\"\n    );\n\n    this._service = new NegociacoesService();\n\n    this._init();\n  }\n\n  _init() {\n    this._service\n      .lista()\n      .then((negociacoes) =>\n        negociacoes.forEach((negociacao) => {\n          this._listaNegociacoes.adiciona(negociacao);\n        })\n      )\n      .catch((e) => {\n        console.log(e);\n        this._mensagem.texto = e;\n      });\n\n    setInterval(() => {\n      this.importarNegociacoes();\n    }, 3000);\n  }\n\n  adiciona(event) {\n    event.preventDefault();\n\n    let negociacao = this._criaNegociacao();\n    this._service\n      .cadastrar(negociacao)\n      .then((message) => {\n        this._listaNegociacoes.adiciona(negociacao);\n        this._mensagem.texto = message;\n\n        this._limpaForm();\n      })\n      .catch((e) => (this._mensagem.texto = e));\n  }\n\n  importarNegociacoes() {\n    this._service\n      .importa(this._listaNegociacoes)\n      .then((negociacoes) => {\n        this._mensagem.texto = \"Negociações importadas com sucesso\";\n        negociacoes.forEach((negociacao) =>\n          this._listaNegociacoes.adiciona(negociacao)\n        );\n      })\n      .catch((e) => (this._mensagem.texto = e));\n  }\n\n  sort(prop) {\n    if (this._ordenacao == prop) {\n      this._listaNegociacoes.sortInverse();\n    } else {\n      this._listaNegociacoes.sort(prop);\n    }\n\n    this._ordenacao = prop;\n  }\n\n  esvazia() {\n    this._service\n      .apaga()\n      .then((message) => {\n        this._mensagem.texto = message;\n        this._listaNegociacoes.esvazia();\n      })\n      .catch((e) => (this._mensagem.texto = e));\n  }\n\n  _criaNegociacao() {\n    return new Negociacao(\n      DateHelper.toDate(this._inputData.value),\n      parseInt(this._inputQuantidade.value),\n      parseFloat(this._inputValor.value)\n    );\n  }\n\n  _limpaForm() {\n    this._inputData.value = \"\";\n    this._inputQuantidade.value = 1;\n    this._inputValor.value = 0.0;\n\n    this._inputData.focus();\n  }\n}\n\nconst negociacaoController = new NegociacaoController();\nexport default function currentInstance() {\n  return negociacaoController;\n}\n"]}