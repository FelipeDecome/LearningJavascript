{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_ordenacao","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_service","NegociacoesService","_init","lista","then","negociacoes","forEach","negociacao","adiciona","catch","e","console","log","texto","setInterval","importarNegociacoes","event","preventDefault","_criaNegociacao","cadastrar","message","_limpaForm","importa","prop","sortInverse","sort","apaga","esvazia","Negociacao","DateHelper","toDate","value","parseInt","parseFloat","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\n  constructor() {\n    let $ = document.querySelector.bind(document);\n    this._inputData = $(\"#data\");\n    this._inputQuantidade = $(\"#quantidade\");\n    this._inputValor = $(\"#valor\");\n\n    this._ordenacao = \"\";\n\n    this._listaNegociacoes = new Bind(\n      new ListaNegociacoes(),\n      new NegociacoesView($(\"#negociacoesView\")),\n      \"adiciona\",\n      \"esvazia\",\n      \"sort\",\n      \"sortInverse\"\n    );\n\n    this._mensagem = new Bind(\n      new Mensagem(),\n      new MensagemView($(\"#mensagemView\")),\n      \"texto\"\n    );\n\n    this._service = new NegociacoesService();\n\n    this._init();\n  }\n\n  _init() {\n    this._service\n      .lista()\n      .then((negociacoes) =>\n        negociacoes.forEach((negociacao) => {\n          this._listaNegociacoes.adiciona(negociacao);\n        })\n      )\n      .catch((e) => {\n        console.log(e);\n        this._mensagem.texto = e;\n      });\n\n    setInterval(() => {\n      this.importarNegociacoes();\n    }, 3000);\n  }\n\n  adiciona(event) {\n    event.preventDefault();\n\n    let negociacao = this._criaNegociacao();\n    this._service\n      .cadastrar(negociacao)\n      .then((message) => {\n        this._listaNegociacoes.adiciona(negociacao);\n        this._mensagem.texto = message;\n\n        this._limpaForm();\n      })\n      .catch((e) => (this._mensagem.texto = e));\n  }\n\n  importarNegociacoes() {\n    this._service\n      .importa(this._listaNegociacoes)\n      .then((negociacoes) => {\n        this._mensagem.texto = \"Negociações importadas com sucesso\";\n        negociacoes.forEach((negociacao) =>\n          this._listaNegociacoes.adiciona(negociacao)\n        );\n      })\n      .catch((e) => (this._mensagem.texto = e));\n  }\n\n  sort(prop) {\n    if (this._ordenacao == prop) {\n      this._listaNegociacoes.sortInverse();\n    } else {\n      this._listaNegociacoes.sort(prop);\n    }\n\n    this._ordenacao = prop;\n  }\n\n  esvazia() {\n    this._service\n      .apaga()\n      .then((message) => {\n        this._mensagem.texto = message;\n        this._listaNegociacoes.esvazia();\n      })\n      .catch((e) => (this._mensagem.texto = e));\n  }\n\n  _criaNegociacao() {\n    return new Negociacao(\n      DateHelper.toDate(this._inputData.value),\n      parseInt(this._inputQuantidade.value),\n      parseFloat(this._inputValor.value)\n    );\n  }\n\n  _limpaForm() {\n    this._inputData.value = \"\";\n    this._inputQuantidade.value = 1;\n    this._inputValor.value = 0.0;\n\n    this._inputData.focus();\n  }\n}\n"]}